

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Devices and Protocols &mdash; CXL: Boot To Bash  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=949a1ff5" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx_lesson.css?v=e9df6548" />
      <link rel="stylesheet" type="text/css" href="../../_static/term_role_formatting.css?v=4194e21c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=187304be"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=582ca9e2"></script>
      <script src="../../_static/minipres.js?v=a0d29692"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script data-domain="coderefinery.github.io" defer="defer" src="https://plausible.cs.aalto.fi/js/script.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="UEFI Data" href="../uefi/" />
    <link rel="prev" title="CXL on Linux: Boot To Bash" href="../../" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../" class="icon icon-home">
            CXL: Boot To Bash
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../">CXL on Linux: Boot To Bash</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Device Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Devices and Protocols</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#protocols">Protocols</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cxl-io">CXL.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cxl-cache">CXL.cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cxl-mem">CXL.mem</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#device-types">Device Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#type-1">Type-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#type-2">Type-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#type-3">Type-3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#switch">Switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logical-devices-and-heads">Logical Devices and Heads</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mhsld">MHSLD</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mhmld">MHMLD</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-devices">Example Devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#memory-expander">Memory Expander</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-capacity-device-dcd">Dynamic Capacity Device (DCD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-t2-device">Example T2 Device</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../uefi/">UEFI Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Platform Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../platform/bios-and-efi/">BIOS/EFI Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platform/acpi/">ACPI Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platform/example-configs/">Example Platform Configurations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Linux Kernel Configuration:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../linux/overview/">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux/early-boot/">Linux Init (Early Boot)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux/cxl-driver/">CXL Driver Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux/dax-driver/">DAX Driver Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux/memory-hotplug/">Memory Hotplug</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Memory Allocation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../allocation/dax/">DAX Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../allocation/page-allocator/">The Page Allocator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../allocation/reclaim/">Reclaim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../allocation/hugepages/">Huge Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../allocation/tiering/">Memory Tiering</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use Cases</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../use-case/memory-expansion/">Memory Expansion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use-case/dynamic-capacity/">Dynamic Capacity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use-case/virtual-machines/">Virtual Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use-case/shared-memory/">Shared Memory</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">CXL: Boot To Bash</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Devices and Protocols</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/gourryinverse/cxl-boot-to-bash/blob/main/doc/devices/device-types.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="devices-and-protocols">
<h1>Devices and Protocols<a class="headerlink" href="#devices-and-protocols" title="Link to this heading"></a></h1>
<p>The type of CXL device (Memory, Accelerator, etc) dictates many configuration steps. This section
covers some basic background on device types and on-device resources used by the platform and OS
which impact configuration.</p>
<section id="protocols">
<h2>Protocols<a class="headerlink" href="#protocols" title="Link to this heading"></a></h2>
<p>There are three core protocols to CXL.  For the purpose of this documentation,
we will only discuss very high level definitions as the specific hardware
details are largely abstracted away from Linux.  See the CXL specification
for more details.</p>
<section id="cxl-io">
<h3>CXL.io<a class="headerlink" href="#cxl-io" title="Link to this heading"></a></h3>
<p>The basic interaction protocol, similar to PCIe configuration mechanisms.
Typically used for initialization, configuration, and I/O access for anything
other than memory (CXL.mem) or cache (CXL.cache) operations.</p>
<p>The Linux CXL driver exposes access to .io functionalty via the various sysfs
interfaces and /dev/cxl/ devices (which exposes direct access to device
mailboxes).</p>
</section>
<section id="cxl-cache">
<h3>CXL.cache<a class="headerlink" href="#cxl-cache" title="Link to this heading"></a></h3>
<p>The mechanism by which a device may coherently access and cache host memory.</p>
<p>Largely transparent to Linux once configured.</p>
</section>
<section id="cxl-mem">
<h3>CXL.mem<a class="headerlink" href="#cxl-mem" title="Link to this heading"></a></h3>
<p>The mechanism by which the CPU may coherently access and cache device memory.</p>
<p>Largely transparent to Linux once configured.</p>
</section>
</section>
<section id="device-types">
<h2>Device Types<a class="headerlink" href="#device-types" title="Link to this heading"></a></h2>
<section id="type-1">
<h3>Type-1<a class="headerlink" href="#type-1" title="Link to this heading"></a></h3>
<p>A Type-1 CXL device:</p>
<ul class="simple">
<li><p>Supports cxl.io and cxl.cache protocols</p></li>
<li><p>Implements a fully coherent cache</p></li>
<li><p>Allow Device-to-Host coherence and Host-to-Device snoops.</p></li>
<li><p>Does NOT have host-managed device memory (HDM)</p></li>
</ul>
<p>Typical examples of type-1 devices is a Smart NIC - which may want to
directly operate on host-memory (DMA) to store incoming packets. These
devices largely rely on CPU-attached memory.</p>
</section>
<section id="type-2">
<h3>Type-2<a class="headerlink" href="#type-2" title="Link to this heading"></a></h3>
<p>A Type-2 CXL Device:</p>
<ul class="simple">
<li><p>Supports cxl.io, cxl.cache, and cxl.mem protocols</p></li>
<li><p>Optionally implements coherent cache and Host-Managed Device Memory</p></li>
<li><p>Is typically an accelerator device w/ high bandwidth memory.</p></li>
</ul>
<p>The primary difference between a type-1 and type-2 device is the presence
of host-managed device memory, which allows the device to operate on a
local memory bank - while the CPU sill has coherent DMA to the same memory.</p>
<p>The allows things like GPUs to expose their memory via DAX devices or file
descriptors, allows drivers and programs direct access to device memory
rather than use block-transfer semantics.</p>
</section>
<section id="type-3">
<h3>Type-3<a class="headerlink" href="#type-3" title="Link to this heading"></a></h3>
<p>A Type-3 CXL Device</p>
<ul class="simple">
<li><p>Supports cxl.io and cxl.mem</p></li>
<li><p>Implements Host-Managed Device Memory</p></li>
<li><p>May provide either Volatile or Persistent memory capacity (or both).</p></li>
</ul>
<p>A basic example of a type-3 device is a simple memory expanded, whose
local memory capacity is exposed to the CPU for access directly via
basic coherent DMA.</p>
</section>
<section id="switch">
<h3>Switch<a class="headerlink" href="#switch" title="Link to this heading"></a></h3>
<p>A CXL switch is a device capacity of routing any CXL (and by extension, PCIe)
protocol between an upstream, downstream, or peer devices.  Many devices, such
as Multi-Logical Devices, imply the presence of switching in some manner.</p>
</section>
<section id="logical-devices-and-heads">
<h3>Logical Devices and Heads<a class="headerlink" href="#logical-devices-and-heads" title="Link to this heading"></a></h3>
<p>A CXL device may present one or more “Logical Devices” to one or more hosts
(via physical “Heads”).</p>
<p>A Single-Logical Device (SLD) is a device which presents a single device to
one or more heads.</p>
<p>A Multi-Logical Device (MLD) is a device which may present multiple devices
to one or more devices.</p>
<p>A Single-Headed Device exposes only a single physical connection.</p>
<p>A Multi-Headed Device exposes multiple physical connections.</p>
<section id="mhsld">
<h4>MHSLD<a class="headerlink" href="#mhsld" title="Link to this heading"></a></h4>
<p>A Multi-Headed Single-Logical Device (MHSLD) exposes a single logical
device to multiple heads which may be connected to one or more discrete
hosts.  An example of this would be a simple memory-pool which may be
statically configured (prior to boot) to expose portions of its memory
to Linux via the CEDT ACPI table.</p>
</section>
<section id="mhmld">
<h4>MHMLD<a class="headerlink" href="#mhmld" title="Link to this heading"></a></h4>
<p>A Multi-Headed Multi-Logical Device (MHMLD) exposes multiple logical
devices to multiple heads which may be connected to one or more discrete
hosts.  An example of this would be a Dynamic Capacity Device or which
may be configured at runtime to expose portions of its memory to Linux.</p>
</section>
</section>
</section>
<section id="example-devices">
<h2>Example Devices<a class="headerlink" href="#example-devices" title="Link to this heading"></a></h2>
<section id="memory-expander">
<h3>Memory Expander<a class="headerlink" href="#memory-expander" title="Link to this heading"></a></h3>
<p>The simplest form of Type-3 device is a memory expander.  A memory expander
exposes Host-Managed Device Memory (HDM) to Linux.  This memory may be
Volatile or Non-Volatile (Persistent).</p>
<p>Memory Expanders will typically be considered a form of Single-Headed,
Single-Logical Device - as its form factor will typically be an add-in-card
(AIC) or some other similar form-factor.</p>
<p>The Linux CXL driver provides support for static or dynamic configuration of
basic memory expanders.  The platform may program decoders prior to OS init
(e.g. auto-decoders), or the user may program the fabric if the platform
defers these operations to the OS.</p>
<p>Multiple Memory Expanders may be added to an external chassis and exposed to
a host via a head attached to a CXL switch.  This is a “memory pool”, and
would be considered an MHSLD or MHMLD depending on the management capabilities
provided by the switch platform.</p>
<p>As of v6.14, Linux does not provide a formalized interface to manage non-DCD
MHSLD or MHMLD devices.</p>
</section>
<section id="dynamic-capacity-device-dcd">
<h3>Dynamic Capacity Device (DCD)<a class="headerlink" href="#dynamic-capacity-device-dcd" title="Link to this heading"></a></h3>
<p>A Dynamic Capacity Device is a Type-3 device which provides dynamic management
of memory capacity. The basic premise of a DCD to to provide an allocator-like
interface for physical memory capacity to a “Fabric Manager” (an external,
privileged host with privileges to change configurations for other hosts).</p>
<p>A DCD manages “Memory Extents”, which may be volatile or persistent. Extents
may also be exclusive to a single host or shared across multiple.</p>
<p>As of v6.14, Linux does not provide a formalized interface to manage DCD
devices, however there is active work on LKML targeting future release.</p>
</section>
<section id="example-t2-device">
<h3>Example T2 Device<a class="headerlink" href="#example-t2-device" title="Link to this heading"></a></h3>
<p>Todo</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../" class="btn btn-neutral float-left" title="CXL on Linux: Boot To Bash" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../uefi/" class="btn btn-neutral float-right" title="UEFI Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Gregory Price.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>